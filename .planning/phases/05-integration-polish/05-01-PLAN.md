# Phase 5 Plan 1: Integration & Polish

## Context

**Phase Goal**: Connect UI to existing SDLC orchestrator, add progress tracking and visual polish

**Current State**:
- Phases 1-4 complete - Planning UI fully functional with PRD, Tech Spec, ADR generation and export
- Standalone workflow using `planningSessions` Map (in-memory storage)
- Existing `SDLCOrchestrator` class in codebase (src/sdlc/orchestrator.ts) manages full 6-phase projects
- Planning UI covers first 2 SDLC phases (Requirements, Design); Orchestrator handles all 6
- No integration between planning UI and orchestrator currently
- Session data lost on browser refresh

**Dependencies**:
- Phase 4 (File Generation & Export) ✓ Complete
- Existing SDLCOrchestrator class (src/sdlc/orchestrator.ts)
- Planning session types (PlanningSession interface)

**Discovery**: Level 0 (skip) - Internal integration with existing patterns

## Objective

Enhance planning UI with visual polish, session persistence, and optional SDLC orchestrator integration for transitioning from planning to implementation.

## Scope

**In Scope**:
- Enhanced progress visualization (phase completion badges, progress bar)
- Session persistence using localStorage (survive browser refresh)
- Help text and tooltips for guided experience
- Optional "Create Implementation Project" button to bridge planning → orchestrator
- Loading states and animations for better UX
- Error state improvements

**Out of Scope**:
- Full SDLC orchestrator replacement (planning UI remains standalone option)
- Multi-user features or collaboration
- Authentication or access control
- Real-time sync or WebSockets
- Git integration automation
- Mobile-responsive redesign (existing glassmorphic design is sufficient)

## Tasks

### Task 1: Enhanced Progress Visualization

**What**: Add visual progress tracking throughout the planning workflow

**Acceptance Criteria**:
- Phase completion badges (✓ Complete, In Progress, Locked) on planning page header
- Overall progress bar showing percentage (0%, 33%, 67%, 100%)
- Phase status indicators using color coding:
  - Green: Complete
  - Blue: In Progress
  - Gray: Locked/Not Started
- Document generation status badges on each phase (e.g., "PRD Generated ✓")
- Real-time progress updates as user completes steps

**Implementation Notes**:
- Add CSS classes for badge styles (.badge-complete, .badge-in-progress, .badge-locked)
- Update phase stepper to show completion checkmarks
- Add progress bar div at top of planning page (0-100% width animation)
- Calculate progress: Requirements complete = 33%, Design complete = 67%, All docs exported = 100%

**Estimated Effort**: 30 min

---

### Task 2: Session Persistence with localStorage

**What**: Implement localStorage backup to preserve planning session across browser refreshes

**Acceptance Criteria**:
- Session data automatically saved to localStorage on every change
- Session restored on page load if localStorage data exists
- "Resume Session" prompt if existing session found
- "Start New Session" button clears localStorage and starts fresh
- Session includes: project name, form data, generated documents, current phase
- Data serialization handles Date objects correctly

**Implementation Notes**:
- Key: `planning-session-{sessionId}` in localStorage
- Save on autosave triggers (already implemented for forms)
- Add `loadSessionFromStorage()` function called on page init
- Add modal prompt: "Resume your planning session for '{projectName}'?" with Resume/Start New buttons
- Serialize/deserialize using JSON with Date reviver function

**Estimated Effort**: 40 min

---

### Task 3: Help Text & Guided Experience

**What**: Add contextual help, tooltips, and guidance throughout the workflow

**Acceptance Criteria**:
- Help icon (ⓘ) next to each phase in stepper with tooltip explaining phase purpose
- Placeholder text in form fields with examples (e.g., "e.g., User Authentication System")
- Character count helpers showing min/max requirements
- "What's This?" tooltips on technical terms (ADR, PRD, Tech Spec)
- Onboarding modal on first visit explaining workflow (localStorage flag to show once)
- Help panel (collapsible) with FAQ and workflow overview

**Implementation Notes**:
- Use CSS title attribute for simple tooltips (no library needed)
- Add `.help-icon` spans with hover states
- Onboarding modal: Check `localStorage.getItem('planning-onboarding-seen')`, show if null
- Help panel: Fixed position, slide-in animation, dismissible
- Content: Brief explanations of each phase and expected outputs

**Estimated Effort**: 35 min

---

### Task 4: Optional SDLC Orchestrator Integration

**What**: Add "Create Implementation Project" button to bridge planning workflow to orchestrator

**Acceptance Criteria**:
- "Create Implementation Project" button appears after all phases complete (Requirements + Design)
- Button calls `SDLCOrchestrator.startProject()` with planning data
- Creates Project in orchestrator with:
  - Project name from planning session
  - Description from requirements
  - Current phase set to IMPLEMENTATION (skips REQUIREMENTS/DESIGN since done)
  - Custom deliverables for Implementation phase
- Success message: "Implementation project created! View in SDLC dashboard."
- Link to SDLC dashboard (existing `/` route)
- Button disabled if project already created (track in planning session)

**Implementation Notes**:
- Import SDLCOrchestrator in server.ts planning route
- Add POST `/api/planning/create-implementation-project` endpoint
- Map PlanningSession data to Project params:
  ```typescript
  orchestrator.startProject({
    name: session.projectName,
    description: session.phaseData.requirements?.description || '',
    customDeliverables: [ /* Implementation deliverables */ ]
  })
  ```
- Add `implementationProjectId?: string` field to PlanningSession
- Button appears in displayTechSpecAndADRs after all docs generated

**Estimated Effort**: 45 min

---

### Task 5: Loading States & Animation Polish

**What**: Improve loading states, animations, and visual feedback

**Acceptance Criteria**:
- Spinner/loading indicator during Claude API calls (PRD, Tech Spec, ADR generation)
- Smooth transitions between steps (fade-in/fade-out, slide animations)
- Button hover states with subtle animations
- Success animations when completing phases (green checkmark pulse)
- Document generation progress: "Generating PRD... (this may take 20-30 seconds)"
- Error state improvements: Clear error messages with retry buttons

**Implementation Notes**:
- Add CSS keyframe animations for fade, slide, pulse
- Loading spinner: CSS-only (no library), show during API fetch
- Use `setTimeout` for staggered element animations (e.g., badges appear one by one)
- Error messages: Red background, dismiss button, auto-hide after 5 seconds
- Progress animations: CSS transitions on width changes

**Estimated Effort**: 30 min

---

### Task 6: Final Verification & Testing

**What**: End-to-end testing of complete workflow with all polish features

**Verification Steps**:
1. Start new planning session
2. Verify onboarding modal shows (first time only)
3. Complete Requirements phase, verify progress updates (33%)
4. Refresh browser, verify session resume prompt
5. Complete Design phase, verify progress updates (67%)
6. Export all documentation, verify progress reaches 100%
7. Click "Create Implementation Project", verify orchestrator integration
8. Verify localStorage cleanup on "Start New Session"
9. Test help tooltips and guided experience
10. Verify all animations and loading states work smoothly

**Success Criteria**:
- Complete workflow executes without errors
- Session persists across browser refreshes
- Progress tracking updates correctly
- Orchestrator integration creates valid Project
- All visual polish elements render correctly

**Estimated Effort**: 20 min

---

## Execution Strategy

**Strategy**: Linear (Tasks 1 → 2 → 3 → 4 → 5 → 6) - Polish tasks build on each other

**Reasoning**:
- Task 1 (progress viz) provides foundation for Task 2 (persistence)
- Task 2 (persistence) enables Task 3 (onboarding) to work properly
- Task 4 (orchestrator) depends on complete workflow from Tasks 1-3
- Task 5 (animations) enhances all previous tasks
- Task 6 (verification) validates everything together

**No Checkpoints**: All tasks are polish/enhancement work with low risk

**Agent Assignment**: Self-implementation (straightforward UI/UX enhancements)

## Success Criteria

**Phase Complete When**:
- ✅ Enhanced progress tracking shows phase completion and overall progress
- ✅ Session persistence works across browser refreshes
- ✅ Help text and tooltips guide users through workflow
- ✅ Optional orchestrator integration creates implementation projects
- ✅ Loading states and animations provide smooth UX
- ✅ End-to-end workflow tested and verified

**Deliverables**:
1. Progress visualization UI (badges, progress bar)
2. localStorage session persistence
3. Help/guidance system (tooltips, onboarding, help panel)
4. SDLC orchestrator integration endpoint and UI button
5. Animation and loading state improvements
6. Verified complete workflow

## Risk Assessment

**Low Risk** - All tasks are UI/UX enhancements on existing stable foundation

**Potential Issues**:
1. **localStorage quota exceeded** - Mitigated by storing only essential session data (not full documents)
2. **Orchestrator API mismatch** - Mitigated by reading orchestrator.ts interface before implementation
3. **Animation performance** - Mitigated by CSS-only animations (no JavaScript animation loops)
4. **Session serialization errors** - Mitigated by explicit Date handling in JSON serialization

**No Breaking Changes** - All enhancements are additive; existing workflow continues to function
